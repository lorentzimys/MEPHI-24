# Модуль 5. Аудит, пентест и современные методы выявления уязвимостей

## SQL Injection‑логин — войдите без регистрации, обойдя форму через SQL‑инъекцию

### Что было сделано

Была реализована атака через SQL-инъекцию в форме авторизации пользователя через поле логина

### Какой запрос/payload использовался и почему

Для реализации SQL атаки был использован стандартный шаблон SQL-инъекции, который закрывает текущее выражение, добавляет truthy-условие и ставит символ комментирования далее, таким образом, чтобы последующая часть SQL -запроса не была выполнена.

![alt text](image-3.png)

### Как была найдена уязвимость

В форме отзывов в одном из товаров был обнаружен потенциальный email админа.
![alt text](image-2.png)

Форма ввода пароля - идеальное место для SQL-атак.

Успешная реализация SQL-инъекции:
![alt text](image.png)

### Как можно защититься от данной уязвимости

Использовать стандартные практики защиты от SQL-инъекций - экранирование ввода

### Какие риски несет данная уязвимость

В данном случае уязвимость позволяет получить админский доступ к сервису, что является критичным

---

## Stored XSS — внедрите скрипт, получите cookie/JWT admin‑учетки и подтвердите захват сессии.

### Что было сделано

Была реализована атака Stored XSS, при которой мы сохранили вредоносный js код, хранящийся в БД и исполняемый при рендере определенной страницы

### Как была найдена уязвимость

Для реализации атаки использовалось поле ввода отзывов в приложении, где сперва вводились различные варианты XSS инъекций. 
![alt text](image-4.png)

Далее оставалось найти место, где данная уязвимость эксплуатировалась.
Оно было найдено в функционале экспорта данных 
![alt text](image-5.png)

Далее остается только сформировать необходимый payload для атаки, которая позволила бы получить ценную информацию со стороны другого пользователя (целимся на админа).

Был использован сторонний сервис https://webhook.site - на который отправляется запрос, содержащий данные о куках пользователя.
![alt text](image-6.png)

Далее остается только дождаться, когда целевой пользователь запросит экспорт данных и стригеррит выполнение уязвимого кода...

### Как можно защититься от данной уязвимости

- Экранировать HTML-вывод — особенно переменные, вставляемые в HTML, JS, атрибуты.

- Использовать Content Security Policy (CSP) — запретить выполнение встроенных скриптов.

- Валидация и фильтрация входных данных — удалять потенциально опасные теги 

---


## Administration Access



## Backup & Crack

Если попробовать подставить в путь сервиса /ftp, то откроется незакрытый путь в ftp серверу:
![alt text](image-7.png)

Пробуем скачать coupons_2013.md.bak - ошибка, можно скачать только MD и PDF
![alt text](image-8.png)

Пробуем эксплуатировать null byte уязвимость, подставив ``%2500.md`` в конце:
![alt text](image-9.png)

Файл успешно скачался!

![alt text](image-10.png)